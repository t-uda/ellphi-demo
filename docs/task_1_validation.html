<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        const scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          const element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          const hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          const newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((_entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>task_1_validation.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>task 1 validation</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/index-3OIHLLq_.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/preload-helper-g1IWzEZ-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chunk-LvLJmgfZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/react-XTZdWHwa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/compiler-runtime-QczY1yfQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useEventListener-4mpeqPxW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/react-dom-BZDtXk6t.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/jsx-runtime-DUsrKwmN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Combination-D2HqSOvH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/clsx-FpJB9huX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cn-Cs2e4A8T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/menu-items-B57SjdWM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/hotkeys-Dh4gy4JD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/button-D8mnDDLX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-Dj-O1Spr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/createLucideIcon-BJ2I6csQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/check-CWbw3kKW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/select-CgZgQ5hV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/multi-map-D3NvLiI9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chevron-right-B_qBg_RU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dropdown-menu-Ciqx4yT-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tooltip-DqNvr2Rw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_Uint8Array-BGESiCQL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_getTag-BWqNuuwU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseIsEqual-C8v2yRqO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/jotai-D74Ef_p1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/invariant-Amh6wt4N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/isArrayLikeObject-BkJc8lDE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/merge-5YNOh9ZD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/zod-BBqism5D.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/utils-x9KlwLm7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/requests-THIDPq-F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/once-BxRirs3K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toDate-Y5T6FHPx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/isSymbol-BGkTcW3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toString-DlRqgfqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseSlice-BoaxdS7L.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_hasUnicode-CNlKPr15.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useLifecycle-8fgb5Nue.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/capitalize-L9-XHPtm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ai-model-dropdown-CO52rzQt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/badge-Cm0WUI-_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/use-toast-DKTyV2AR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/constants-BmIIVBf_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Deferred-9HYzcD3r.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/config-CbG7e0K6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/uuid-B8w6pjWV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/DeferredRequestRegistry-DfLQSvoS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/connection-B11rCPnY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useNonce-D8CLFIrY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/capabilities-Bdlrhekp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/createReducer-VgoBNe3M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-C3a_7WFa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-0z0sEYV-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BzfTz_Dx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DmruaXMM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DU0YrNRK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-_bGPtAsk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DsSBESho.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-B2TjmP7E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BzDb7E9f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/stex-C4ZxI0N3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cjs-Ba5CQnxe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_arrayReduce-DdxhySYh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/type-kFt-n-jZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseProperty-D0ckTA0L.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toNumber-GB_lFVaq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/now-CAWn5i9V.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/debounce-Bgq-wc7M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toInteger-Cl1doThW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/main-CC_mbgxK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cells-DoKM12vd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/kbd-EdFdwHEs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/renderShortcut-CLenKJO6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useEvent-l9BzRqpK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDeleteCell-BDBSmjLV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/lazy-Cbg8zRvU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/defaultLocale-8c1ixjJ_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/precisionRound-CQhbsDNz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/defaultLocale-BECdiY5x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vega-loader.browser-DZ31-605.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tooltip-CSAGVmjx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ErrorBoundary-6EjkHrSV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/alert-dialog-D9SwG8oA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dialog-BPIq0Dmw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDebounce-C9S6xmGh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/numbers-BigybruE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/SSRProvider-DlZbKHsu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/context-CO64Gasq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useNumberFormatter-B5HAJDUq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/usePress-DHxqjtDm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/input-CVoLDDk-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ImperativeModal-ameyIrhc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cell-link-BiAu_8pk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/alert-D5BMn3Et.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/links-Iv0WhyKW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/state-i7G4J1VS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/MarimoErrorOutput-Bh7Bgl2Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/copy-BS3uwoaq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/copy-DhmkXAPp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/copy-icon-Lyk2_Z8G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/spinner-DpaQpaiI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-D1pae9A2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/focus-CyxSol0W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/popover-DZBXSGEz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useRunCells-DT1En-Te.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mode-DKDAYLK9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/purify.es-hXMlfS4W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/RenderHTML-Dlz0Ew2i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/table-CesNYRF-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tabs-BjAbB8w_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/add-missing-import-DV1FOw9w.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useAsyncData-_-DLduEH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useIframeCapabilities-r0LQMxAQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/LazyAnyLanguageCodeMirror-C7KtNlRp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/error-banner-C9tkg1MX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/formats-C3exma5i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useTheme-DpA-8Qyy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/en-US-Lc4gASCJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/isValid-Cd_L_2Pm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/maps-D4abje2p.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/shim-D-ElLTBO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/download-CCvBQ7qL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/extends-C2lJEiP_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/emotion-is-prop-valid.esm-c4A1huxA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDateFormatter-BMdQ9MI_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/katex-BmfUoCWW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/marked.esm-idL59iHw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chunk-T7OEMACY-CdGEwedE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/range-Bbli-TEL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/table-kHJ0xpFt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Output-DxdWGPFi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/name-cell-input-C6ZYU6mN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useHotkey-B0ylhc2m.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CqHWOZu2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BcLYYUSi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BVXr6b5T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BrEX5EQl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CalRK9ms.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-Cc4T7UUX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-D3MC5WiF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DgaCIZAa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-rqHtY98i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-tj-jaP-y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-w7c0BKrD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CCZcRJI9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CrDb6akR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/apl-BQt6lLuE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/asciiarmor-BjX7bs0j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/asn1-xn1MtyoW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/brainfuck-BjO-UY1i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/clike-DW9tQWfF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/clojure-BSW96HRx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cmake-C7UlMfz3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cobol-CyWIev3Y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/coffeescript-DTvziYTK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/commonlisp-yMdkdGMi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/crystal-BGnoSp3z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/css-D7fWzevp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cypher-Cr1dl0Qf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/d-C2bS5bA6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/diff-B2mHQyn6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dtd-Cy-lUE7p.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dylan-mm60grwk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ecl-Cqi05Wy1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/eiffel-FkvfLQq7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/elm-Da5txHw0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/erlang-CdnCEH5x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/simple-mode-B185hCuE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/factor-CamlR8EJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/forth-UcMX0m31.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/fortran-DZ_vNVsP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/gas-CM88o6Zj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/gherkin-BhrpTeN9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/groovy-BFju68Wx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/haskell-CrWHY4et.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/haxe-1eKW-tbO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/idl-Do4AwvU2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/javascript-CTXZKRYd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/julia-BRynwHI4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/livescript-ZmIBNA-I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/lua-mUfZ-MRC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mathematica-Dil5dTHO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mbox-Dnkn9wSr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mirc-auEWieOB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mllike-xVJsauJ8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/modelica-B8kajVDm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mscgen-Bsnta1jn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mumps-CMw16b5q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/nsis-DwPdi8sw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ntriples-O5lQxirn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/octave-CMfAar-E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/oz-CLRI9Qww.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pascal-D2M_3HBx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/perl-B8lV7aKt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pig-Bima2bfE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/powershell-v_t41ydu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/properties-ChrStSby.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/protobuf-Bin6kmlf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pug-UWVdYLYW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/puppet-DYrtWvYn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/python-BuKrulde.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/q-CrXUTiVN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/r-Bk2Tiso2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/rpm-CmmZphz3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ruby-ElyOTVeQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/sas-jE3ZlG0K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/scheme-CZF1tRbv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/shell-LqT3ZqMa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/sieve-y15yT7Pp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/smalltalk-pk5PvsMs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/sparql-DTZ_gfPQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/stylus-CrGj0eNT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/swift-tt3PlBbI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tcl-1P4b0GMJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/textile-BHDIuMYh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toml-C8qoqk_i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/troff-DMiF5Zmz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ttcn-cfg-qLZtNU-E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ttcn-BAUp3RZn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/turtle-BizIwmKv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vb-Bn_uCxNL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vbscript-BTKW8Atx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/velocity-CcB05fpi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/verilog-BWdtOJH8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vhdl-CzFOaOHx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/webidl-DDEKCqSy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/xquery-BcF6ZhQP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/yacas-BARQAiXa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/z80-DO_Ep0iT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/esm-DnNh7vdQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/objectWithoutPropertiesLoose-DDabolgJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/esm-Crqxhl3F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/trash-Df8Wb7xS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ConsoleOutput-D8ETq-cc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/icons-BgmgMjOV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/blob-LiDbeYko.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/add-cell-with-ai-85tnyxYo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chart-no-axes-column-BrQ3B3xc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/square-function-D5EEjILG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/spec-DpllSlJD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useInstallPackage-BaAhpZlP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/column-preview-DGBk0umL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useAddCell-DYfGo4T8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toggle-PGHtwx2G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/api-CoLss8_O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/globals-oV9pRUSB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/share-DjbnD3WE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/memoize-DN0TMY36.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/get-CyLJYAfP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseSet-CKSmZC_I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/utilities.esm-DvrcU9Ky.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/floating-outline-DmCT2Mvg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/eye-off-BUwXWtH0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/plus-CiGrWbgb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/readonly-python-code-CkaJ4Tks.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/file-video-camera-BGBfFNDn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/file-text-O5IflCIn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/file-CqXxt3_J.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/types-BMriRmf-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/label-4Nancvon.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/textarea-BnZHy5Jt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/circle-x-Cc9X6U_B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/refresh-ccw-aU2rUkrI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/trash-2-Du5ITnDv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/form-600t_Civ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/field-Dov6YyOV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/switch-Ct8mUApv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useBoolean-Dmwks1uh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDeepCompareMemoize-C8RdAYFq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/types-D0WVpW93.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/prop-types-WJwGTMoZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/es-DAmFxw3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/VisuallyHidden-RqykLBKh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseFlatten-rM2FaX4x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/hasIn-CE-pxQP-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_basePickBy-LbasZ8ix.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pick-FbHfDtcJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/send-LAFRRDPT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/code-xml-DdSOsi73.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/download-Dmmu2U4a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/globe-vMZtva7z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/refresh-cw-BOc7UXm9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/settings-DznrHqbd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/square-DhlBDqyx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/triangle-alert-Bf1kg4xT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DL3W3q-2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/bundle.esm-C-9IAWQU.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cells-wU8qigWB.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Output-DUep6sC9.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ConsoleOutput-BFFTcC5Y.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/index-CJU5NUvF.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "task_1_validation.py",
            "mode": "read",
            "version": "0.18.4",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "poetry"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "full"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import os\nimport sys\nimport IPython\n# Set MPLCONFIGDIR to a writable directory to avoid warnings\nos.environ['MPLCONFIGDIR'] = os.path.join(os.getcwd(), \".cache\", \"matplotlib\")\nos.makedirs(os.environ['MPLCONFIGDIR'], exist_ok=True)\n\nimport marimo as mo\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport ellphi\nimport time\nfrom tqdm import tqdm\nimport pandas as pd\nimport seaborn as sns\nfrom numpy.linalg import inv, norm\n\n# Configure matplotlib for publication quality\nplt.rcParams['pdf.fonttype'] = 42\nplt.rcParams['font.family'] = 'serif'\n\n# Ensure output directories exist\nos.makedirs(\"experiments/apct_2025/validation/figs\", exist_ok=True)\nos.makedirs(\"experiments/apct_2025/validation/data\", exist_ok=True)\n\n# Set random seed for reproducibility\nnp.random.seed(42)\n\nmo.md(\"# Task 1: Computational \u0026 Mathematical Validation\")", "code_hash": "82033c6cf4bd5c06ff9eeb05118a428d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "def generate_random_ellipsoid(dim):\n    \"\"\"Generates a random ellipsoid defined by mean and covariance.\"\"\"\n    mean = np.random.randn(dim)\n    # Generate random covariance matrix\n    A = np.random.randn(dim, dim)\n    cov = A @ A.T + np.eye(dim) * 0.1 # Ensure positive definite\n    return mean, cov", "code_hash": "33f3758d15ac2b3d3d20c12c37c7addd", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n    ## Subtask 1.1: Scalability Benchmark\n\n    **Objective**: Quantify the computational cost of the tangency solver as a function of dimension $n$ and verify the performance gain of the C++ backend.\n\n    **Methodology**:\n    - **Dimensions**: $n \\in \\{2, 3, 5, 10, 20, 50, 100\\}$\n    - **Sample Size**: 1,000 random ellipsoid pairs per dimension.\n    - **Backends**: Comparison between Pure Python and C++ Extension (if available).\n    \"\"\"\n)\n\ndef run_benchmark():\n    dims = [2, 3, 5, 10, 20, 50, 100]\n    n_samples = 1000\n    results = []\n\n    backends = ['python']\n    if ellphi.has_cpp_backend():\n        backends.append('cpp') # Assuming 'cpp' or 'auto' maps to C++ if available\n\n    for dim in tqdm(dims, desc=\"Benchmarking dimensions\"):\n        # Pre-generate data to just measure solver time\n        pairs = []\n        for _ in range(n_samples):\n            m1, c1 = generate_random_ellipsoid(dim)\n            m2, c2 = generate_random_ellipsoid(dim)\n            pcoef = ellphi.coef_from_cov(m1, c1)\n            qcoef = ellphi.coef_from_cov(m2, c2)\n            pairs.append((pcoef, qcoef))\n\n        for backend in backends:\n            start_time = time.time()\n            for pcoef, qcoef in pairs:\n                ellphi.tangency(pcoef, qcoef, backend=backend)\n            end_time = time.time()\n            avg_time_ms = (end_time - start_time) / n_samples * 1000\n            results.append({\n                \"Dimension\": dim,\n                \"Backend\": backend,\n                \"Time (ms)\": avg_time_ms\n            })\n\n    return pd.DataFrame(results)\n\n# Run benchmark if not just viewing\n# In marimo, cells run automatically.\n# We can use a button to trigger re-run if needed, but for now just run.\ndf_benchmark = run_benchmark()\n\n# Save data\ndf_benchmark.to_csv(\"experiments/apct_2025/validation/data/scaling_benchmark.csv\", index=False)", "code_hash": "d6f5cfce0c48da27966224e9c78a67d7", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "# Plotting Subtask 1.1\nfig1, ax1 = plt.subplots(figsize=(6, 4))\n\n# Check if we have multiple backends\nfor backend, group in df_benchmark.groupby(\"Backend\"):\n    ax1.loglog(group[\"Dimension\"], group[\"Time (ms)\"], marker='o', label=f\"Backend: {backend}\")\n\nax1.set_xlabel(\"Dimension ($n$)\")\nax1.set_ylabel(\"Time per Check (ms)\")\nax1.set_title(\"Scalability Benchmark: Ellipsoid Tangency\")\nax1.grid(True, which=\"both\", ls=\"--\", alpha=0.5)\nax1.legend()\n\nplt.tight_layout()\nplt.savefig(\"experiments/apct_2025/validation/figs/scaling_benchmark.pdf\")\nplt.savefig(\"experiments/apct_2025/validation/figs/scaling_benchmark.png\")", "code_hash": "7275dcbdaacb7edffba9ab0477713e9a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Subtask 1.2: Gradient Correctness (Finite Difference Check)\n\n**Objective**: Empirically prove the differentiability of the contact time $t$. The analytical gradient must match the numerical gradient to high precision. This validates the \"Trust Layer\" required for gradient-based optimization.\n\n**Methodology**:\n- **Procedure**: Compare **Analytical Gradient** $\\nabla_{\\text{ana}}$ (derived from Implicit Function Theorem) vs. **Numerical Gradient** $\\nabla_{\\text{num}}$ (Central Finite Difference).\n- **Perturbation**: $\\epsilon = 10^{-6}$\n- **Success Criterion**: Relative Error $\\frac{\\|\\nabla_{\\text{ana}} - \\nabla_{\\text{num}}\\|_F}{\\|\\nabla_{\\text{ana}}\\|_F} \u003C 10^{-5}$.\n\"\"\")", "code_hash": "8925969f58eaa6bbe15512d14ba7f984", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "def compute_analytical_gradient(m1, c1, m2, c2, t, point):\n    \"\"\"\n    Computes analytical gradient of t w.r.t m2 (center of second ellipsoid).\n\n    Uses the implicit function theorem on the tangency condition:\n    n1 + lambda * n2 = 0\n    \"\"\"\n    C1_inv = inv(c1)\n    C2_inv = inv(c2)\n\n    n1 = C1_inv @ (point - m1)\n    n2 = C2_inv @ (point - m2)\n\n    # Calculate lambda\n    norm_n1 = norm(n1)\n    norm_n2 = norm(n2)\n\n    # Avoid division by zero\n    if norm_n2 \u003C 1e-12:\n        return np.zeros_like(m2)\n\n    lamb = norm_n1 / norm_n2\n\n\n\n    grad = - n2 / (t * (1.0 + 1.0/lamb))\n\n    return grad\n\ndef tangency_time_func(m_variable, c_variable, m_fixed, c_fixed):\n    pcoef = ellphi.coef_from_cov(m_fixed, c_fixed)\n    qcoef = ellphi.coef_from_cov(m_variable, c_variable)\n    res = ellphi.tangency(pcoef, qcoef)\n    return res.t", "code_hash": "ffb19a83831e4473dc8a3ce6fe794a3d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "_"}, {"code": "def verify_gradients():\n    dims = [2, 5, 10, 20, 50]\n    epsilon = 1e-6\n    results = []\n\n    # For scatter plot\n    scatter_data = {'num': [], 'ana': []}\n\n    for dim in tqdm(dims, desc=\"Verifying Gradients\"):\n        # Use 10 samples per dimension for statistics\n        for _ in range(10): \n            m1, c1 = generate_random_ellipsoid(dim)\n            m2, c2 = generate_random_ellipsoid(dim)\n\n            # Base computation\n            pcoef = ellphi.coef_from_cov(m1, c1)\n            qcoef = ellphi.coef_from_cov(m2, c2)\n            res = ellphi.tangency(pcoef, qcoef)\n            t_base = res.t\n            point = res.point\n\n            # Analytical Gradient\n            grad_ana = compute_analytical_gradient(m1, c1, m2, c2, t_base, point)\n\n            # Numerical Gradient (Finite Difference on m2)\n            grad_num = np.zeros(dim)\n            for i in range(dim):\n                m2_plus = m2.copy()\n                m2_plus[i] += epsilon\n                t_plus = tangency_time_func(m2_plus, c2, m1, c1)\n\n                m2_minus = m2.copy()\n                m2_minus[i] -= epsilon\n                t_minus = tangency_time_func(m2_minus, c2, m1, c1)\n\n                grad_num[i] = (t_plus - t_minus) / (2 * epsilon)\n\n            # Compare\n            # Relative Error: ||ana - num|| / ||ana||\n            diff_norm = norm(grad_ana - grad_num)\n            ana_norm = norm(grad_ana)\n\n            if ana_norm \u003C 1e-12:\n                rel_error = 0.0 # Should not happen with random ellipsoids\n            else:\n                rel_error = diff_norm / ana_norm\n\n            results.append({\n                \"Dimension\": dim,\n                \"Relative Error\": rel_error,\n                \"Log10 Error\": np.log10(rel_error + 1e-20)\n            })\n\n            scatter_data['num'].extend(grad_num.tolist())\n            scatter_data['ana'].extend(grad_ana.tolist())\n\n    return pd.DataFrame(results), pd.DataFrame(scatter_data)\n\ndf_grads, df_scatter = verify_gradients()\n\n# Save results\ndf_grads.to_csv(\"experiments/apct_2025/validation/data/gradient_verification.csv\", index=False)\n\n# Plot Box Plot\nfig2, ax2 = plt.subplots(figsize=(6, 4))\nsns.boxplot(data=df_grads, x=\"Dimension\", y=\"Log10 Error\", ax=ax2)\nax2.axhline(np.log10(1e-5), color='r', linestyle='--', label='Threshold ($10^{-5}$)')\nax2.set_title(\"Gradient Verification: Relative Error Distribution\")\nax2.legend()\nplt.tight_layout()\nplt.savefig(\"experiments/apct_2025/validation/figs/gradient_verification.pdf\")\nplt.savefig(\"experiments/apct_2025/validation/figs/gradient_verification.png\")\n\n# Plot Scatter\nfig3, ax3 = plt.subplots(figsize=(5, 5))\n# Subsample scatter if too large\nsub_scatter = df_scatter.sample(n=min(1000, len(df_scatter))) if len(df_scatter) \u003E 1000 else df_scatter\nax3.scatter(sub_scatter['num'], sub_scatter['ana'], alpha=0.5, s=10)\n\n# Diagonal line\nlims = [\n    np.min([ax3.get_xlim(), ax3.get_ylim()]),  # min of both axes\n    np.max([ax3.get_xlim(), ax3.get_ylim()]),  # max of both axes\n]\nax3.plot(lims, lims, 'k-', alpha=0.75, zorder=0)\nax3.set_xlabel(\"Numerical Gradient\")\nax3.set_ylabel(\"Analytical Gradient\")\nax3.set_title(\"Gradient Alignment\")\nplt.tight_layout()\nplt.savefig(\"experiments/apct_2025/validation/figs/gradient_scatter.png\")", "code_hash": "231d19b0c774a7433e975c8d40b55091", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}], "metadata": {"marimo_version": "0.18.4"}, "version": "1"},
            "session": {"cells": [{"code_hash": "82033c6cf4bd5c06ff9eeb05118a428d", "console": [], "id": "Hbol", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"task-1-computational-mathematical-validation\"\u003ETask 1: Computational \u0026amp; Mathematical Validation\u003C/h1\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "33f3758d15ac2b3d3d20c12c37c7addd", "console": [], "id": "MJUe", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "d6f5cfce0c48da27966224e9c78a67d7", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "\rBenchmarking dimensions:   0%|                                          | 0/7 [00:00\u003C?, ?it/s]\rBenchmarking dimensions:  14%|\u2588\u2588\u2588\u2588\u258a                             | 1/7 [00:00\u003C00:05,  1.05it/s]\rBenchmarking dimensions:  29%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                        | 2/7 [00:01\u003C00:04,  1.03it/s]\rBenchmarking dimensions:  43%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                   | 3/7 [00:02\u003C00:03,  1.01it/s]\rBenchmarking dimensions:  57%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d              | 4/7 [00:03\u003C00:03,  1.00s/it]\rBenchmarking dimensions:  71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e         | 5/7 [00:05\u003C00:02,  1.07s/it]\rBenchmarking dimensions:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f    | 6/7 [00:07\u003C00:01,  1.46s/it]\rBenchmarking dimensions: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 7/7 [00:13\u003C00:00,  2.95s/it]\rBenchmarking dimensions: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 7/7 [00:13\u003C00:00,  1.91s/it]\n", "type": "stream"}], "id": "vblA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "7275dcbdaacb7edffba9ab0477713e9a", "console": [], "id": "bkHC", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": null, "console": [], "id": "lEQa", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": null, "console": [], "id": "PKri", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "8925969f58eaa6bbe15512d14ba7f984", "console": [], "id": "Xref", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"subtask-12-gradient-correctness-finite-difference-check\"\u003ESubtask 1.2: Gradient Correctness (Finite Difference Check)\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003EObjective\u003C/strong\u003E: Empirically prove the differentiability of the contact time \u003Cmarimo-tex class=\"arithmatex\"\u003E||(t||)\u003C/marimo-tex\u003E. The analytical gradient must match the numerical gradient to high precision. This validates the \"Trust Layer\" required for gradient-based optimization.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003EMethodology\u003C/strong\u003E:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EProcedure\u003C/strong\u003E: Compare \u003Cstrong\u003EAnalytical Gradient\u003C/strong\u003E \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\nabla_{\\text{ana}}||)\u003C/marimo-tex\u003E (derived from Implicit Function Theorem) vs. \u003Cstrong\u003ENumerical Gradient\u003C/strong\u003E \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\nabla_{\\text{num}}||)\u003C/marimo-tex\u003E (Central Finite Difference).\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003EPerturbation\u003C/strong\u003E: \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\epsilon = 10^{-6}||)\u003C/marimo-tex\u003E\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003ESuccess Criterion\u003C/strong\u003E: Relative Error \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\frac{\\|\\nabla_{\\text{ana}} - \\nabla_{\\text{num}}\\|_F}{\\|\\nabla_{\\text{ana}}\\|_F} \u0026lt; 10^{-5}||)\u003C/marimo-tex\u003E.\u003C/li\u003E\n\u003C/ul\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "ffb19a83831e4473dc8a3ce6fe794a3d", "console": [], "id": "SFPL", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "231d19b0c774a7433e975c8d40b55091", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "\rVerifying Gradients:   0%|                                              | 0/5 [00:00\u003C?, ?it/s]\rVerifying Gradients: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 5/5 [00:00\u003C00:00,  8.56it/s]\rVerifying Gradients: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 5/5 [00:00\u003C00:00,  8.56it/s]\n", "type": "stream"}], "id": "BYtC", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": null, "console": [], "id": "RGSE", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": null, "console": [], "id": "Kclp", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": null, "console": [], "id": "emfo", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}], "metadata": {"marimo_version": "0.18.4"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.18.4%22%0Aapp%20%3D%20marimo.App(width%3D%22full%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20os%0A%20%20%20%20import%20sys%0A%20%20%20%20import%20IPython%0A%20%20%20%20%23%20Set%20MPLCONFIGDIR%20to%20a%20writable%20directory%20to%20avoid%20warnings%0A%20%20%20%20os.environ%5B'MPLCONFIGDIR'%5D%20%3D%20os.path.join(os.getcwd()%2C%20%22.cache%22%2C%20%22matplotlib%22)%0A%20%20%20%20os.makedirs(os.environ%5B'MPLCONFIGDIR'%5D%2C%20exist_ok%3DTrue)%0A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%20%20%20%20import%20ellphi%0A%20%20%20%20import%20time%0A%20%20%20%20from%20tqdm%20import%20tqdm%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20seaborn%20as%20sns%0A%20%20%20%20from%20numpy.linalg%20import%20inv%2C%20norm%0A%0A%20%20%20%20%23%20Configure%20matplotlib%20for%20publication%20quality%0A%20%20%20%20plt.rcParams%5B'pdf.fonttype'%5D%20%3D%2042%0A%20%20%20%20plt.rcParams%5B'font.family'%5D%20%3D%20'serif'%0A%0A%20%20%20%20%23%20Ensure%20output%20directories%20exist%0A%20%20%20%20os.makedirs(%22experiments%2Fapct_2025%2Fvalidation%2Ffigs%22%2C%20exist_ok%3DTrue)%0A%20%20%20%20os.makedirs(%22experiments%2Fapct_2025%2Fvalidation%2Fdata%22%2C%20exist_ok%3DTrue)%0A%0A%20%20%20%20%23%20Set%20random%20seed%20for%20reproducibility%0A%20%20%20%20np.random.seed(42)%0A%0A%20%20%20%20mo.md(%22%23%20Task%201%3A%20Computational%20%26%20Mathematical%20Validation%22)%0A%20%20%20%20return%20ellphi%2C%20inv%2C%20mo%2C%20norm%2C%20np%2C%20pd%2C%20plt%2C%20sns%2C%20time%2C%20tqdm%0A%0A%0A%40app.cell%0Adef%20_(np)%3A%0A%20%20%20%20def%20generate_random_ellipsoid(dim)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Generates%20a%20random%20ellipsoid%20defined%20by%20mean%20and%20covariance.%22%22%22%0A%20%20%20%20%20%20%20%20mean%20%3D%20np.random.randn(dim)%0A%20%20%20%20%20%20%20%20%23%20Generate%20random%20covariance%20matrix%0A%20%20%20%20%20%20%20%20A%20%3D%20np.random.randn(dim%2C%20dim)%0A%20%20%20%20%20%20%20%20cov%20%3D%20A%20%40%20A.T%20%2B%20np.eye(dim)%20*%200.1%20%23%20Ensure%20positive%20definite%0A%20%20%20%20%20%20%20%20return%20mean%2C%20cov%0A%20%20%20%20return%20(generate_random_ellipsoid%2C)%0A%0A%0A%40app.cell%0Adef%20_(ellphi%2C%20generate_random_ellipsoid%2C%20mo%2C%20pd%2C%20time%2C%20tqdm)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%20%20%20%20%23%23%20Subtask%201.1%3A%20Scalability%20Benchmark%0A%0A%20%20%20%20%20%20%20%20**Objective**%3A%20Quantify%20the%20computational%20cost%20of%20the%20tangency%20solver%20as%20a%20function%20of%20dimension%20%24n%24%20and%20verify%20the%20performance%20gain%20of%20the%20C%2B%2B%20backend.%0A%0A%20%20%20%20%20%20%20%20**Methodology**%3A%0A%20%20%20%20%20%20%20%20-%20**Dimensions**%3A%20%24n%20%5Cin%20%5C%7B2%2C%203%2C%205%2C%2010%2C%2020%2C%2050%2C%20100%5C%7D%24%0A%20%20%20%20%20%20%20%20-%20**Sample%20Size**%3A%201%2C000%20random%20ellipsoid%20pairs%20per%20dimension.%0A%20%20%20%20%20%20%20%20-%20**Backends**%3A%20Comparison%20between%20Pure%20Python%20and%20C%2B%2B%20Extension%20(if%20available).%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%0A%20%20%20%20def%20run_benchmark()%3A%0A%20%20%20%20%20%20%20%20dims%20%3D%20%5B2%2C%203%2C%205%2C%2010%2C%2020%2C%2050%2C%20100%5D%0A%20%20%20%20%20%20%20%20n_samples%20%3D%201000%0A%20%20%20%20%20%20%20%20results%20%3D%20%5B%5D%0A%0A%20%20%20%20%20%20%20%20backends%20%3D%20%5B'python'%5D%0A%20%20%20%20%20%20%20%20if%20ellphi.has_cpp_backend()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20backends.append('cpp')%20%23%20Assuming%20'cpp'%20or%20'auto'%20maps%20to%20C%2B%2B%20if%20available%0A%0A%20%20%20%20%20%20%20%20for%20dim%20in%20tqdm(dims%2C%20desc%3D%22Benchmarking%20dimensions%22)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Pre-generate%20data%20to%20just%20measure%20solver%20time%0A%20%20%20%20%20%20%20%20%20%20%20%20pairs%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20_%20in%20range(n_samples)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20m1%2C%20c1%20%3D%20generate_random_ellipsoid(dim)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20m2%2C%20c2%20%3D%20generate_random_ellipsoid(dim)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pcoef%20%3D%20ellphi.coef_from_cov(m1%2C%20c1)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20qcoef%20%3D%20ellphi.coef_from_cov(m2%2C%20c2)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pairs.append((pcoef%2C%20qcoef))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20backend%20in%20backends%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20start_time%20%3D%20time.time()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20pcoef%2C%20qcoef%20in%20pairs%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ellphi.tangency(pcoef%2C%20qcoef%2C%20backend%3Dbackend)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20end_time%20%3D%20time.time()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20avg_time_ms%20%3D%20(end_time%20-%20start_time)%20%2F%20n_samples%20*%201000%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20results.append(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Dimension%22%3A%20dim%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Backend%22%3A%20backend%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Time%20(ms)%22%3A%20avg_time_ms%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%0A%20%20%20%20%20%20%20%20return%20pd.DataFrame(results)%0A%0A%20%20%20%20%23%20Run%20benchmark%20if%20not%20just%20viewing%0A%20%20%20%20%23%20In%20marimo%2C%20cells%20run%20automatically.%0A%20%20%20%20%23%20We%20can%20use%20a%20button%20to%20trigger%20re-run%20if%20needed%2C%20but%20for%20now%20just%20run.%0A%20%20%20%20df_benchmark%20%3D%20run_benchmark()%0A%0A%20%20%20%20%23%20Save%20data%0A%20%20%20%20df_benchmark.to_csv(%22experiments%2Fapct_2025%2Fvalidation%2Fdata%2Fscaling_benchmark.csv%22%2C%20index%3DFalse)%0A%20%20%20%20return%20(df_benchmark%2C)%0A%0A%0A%40app.cell%0Adef%20_(df_benchmark%2C%20plt)%3A%0A%20%20%20%20%23%20Plotting%20Subtask%201.1%0A%20%20%20%20fig1%2C%20ax1%20%3D%20plt.subplots(figsize%3D(6%2C%204))%0A%0A%20%20%20%20%23%20Check%20if%20we%20have%20multiple%20backends%0A%20%20%20%20for%20backend%2C%20group%20in%20df_benchmark.groupby(%22Backend%22)%3A%0A%20%20%20%20%20%20%20%20ax1.loglog(group%5B%22Dimension%22%5D%2C%20group%5B%22Time%20(ms)%22%5D%2C%20marker%3D'o'%2C%20label%3Df%22Backend%3A%20%7Bbackend%7D%22)%0A%0A%20%20%20%20ax1.set_xlabel(%22Dimension%20(%24n%24)%22)%0A%20%20%20%20ax1.set_ylabel(%22Time%20per%20Check%20(ms)%22)%0A%20%20%20%20ax1.set_title(%22Scalability%20Benchmark%3A%20Ellipsoid%20Tangency%22)%0A%20%20%20%20ax1.grid(True%2C%20which%3D%22both%22%2C%20ls%3D%22--%22%2C%20alpha%3D0.5)%0A%20%20%20%20ax1.legend()%0A%0A%20%20%20%20plt.tight_layout()%0A%20%20%20%20plt.savefig(%22experiments%2Fapct_2025%2Fvalidation%2Ffigs%2Fscaling_benchmark.pdf%22)%0A%20%20%20%20plt.savefig(%22experiments%2Fapct_2025%2Fvalidation%2Ffigs%2Fscaling_benchmark.png%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Subtask%201.2%3A%20Gradient%20Correctness%20(Finite%20Difference%20Check)%0A%0A%20%20%20%20**Objective**%3A%20Empirically%20prove%20the%20differentiability%20of%20the%20contact%20time%20%24t%24.%20The%20analytical%20gradient%20must%20match%20the%20numerical%20gradient%20to%20high%20precision.%20This%20validates%20the%20%22Trust%20Layer%22%20required%20for%20gradient-based%20optimization.%0A%0A%20%20%20%20**Methodology**%3A%0A%20%20%20%20-%20**Procedure**%3A%20Compare%20**Analytical%20Gradient**%20%24%5Cnabla_%7B%5Ctext%7Bana%7D%7D%24%20(derived%20from%20Implicit%20Function%20Theorem)%20vs.%20**Numerical%20Gradient**%20%24%5Cnabla_%7B%5Ctext%7Bnum%7D%7D%24%20(Central%20Finite%20Difference).%0A%20%20%20%20-%20**Perturbation**%3A%20%24%5Cepsilon%20%3D%2010%5E%7B-6%7D%24%0A%20%20%20%20-%20**Success%20Criterion**%3A%20Relative%20Error%20%24%5Cfrac%7B%5C%7C%5Cnabla_%7B%5Ctext%7Bana%7D%7D%20-%20%5Cnabla_%7B%5Ctext%7Bnum%7D%7D%5C%7C_F%7D%7B%5C%7C%5Cnabla_%7B%5Ctext%7Bana%7D%7D%5C%7C_F%7D%20%3C%2010%5E%7B-5%7D%24.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(ellphi%2C%20inv%2C%20norm%2C%20np)%3A%0A%20%20%20%20def%20compute_analytical_gradient(m1%2C%20c1%2C%20m2%2C%20c2%2C%20t%2C%20point)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Computes%20analytical%20gradient%20of%20t%20w.r.t%20m2%20(center%20of%20second%20ellipsoid).%0A%0A%20%20%20%20%20%20%20%20Uses%20the%20implicit%20function%20theorem%20on%20the%20tangency%20condition%3A%0A%20%20%20%20%20%20%20%20n1%20%2B%20lambda%20*%20n2%20%3D%200%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20C1_inv%20%3D%20inv(c1)%0A%20%20%20%20%20%20%20%20C2_inv%20%3D%20inv(c2)%0A%0A%20%20%20%20%20%20%20%20n1%20%3D%20C1_inv%20%40%20(point%20-%20m1)%0A%20%20%20%20%20%20%20%20n2%20%3D%20C2_inv%20%40%20(point%20-%20m2)%0A%0A%20%20%20%20%20%20%20%20%23%20Calculate%20lambda%0A%20%20%20%20%20%20%20%20norm_n1%20%3D%20norm(n1)%0A%20%20%20%20%20%20%20%20norm_n2%20%3D%20norm(n2)%0A%0A%20%20%20%20%20%20%20%20%23%20Avoid%20division%20by%20zero%0A%20%20%20%20%20%20%20%20if%20norm_n2%20%3C%201e-12%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20np.zeros_like(m2)%0A%0A%20%20%20%20%20%20%20%20lamb%20%3D%20norm_n1%20%2F%20norm_n2%0A%0A%0A%0A%20%20%20%20%20%20%20%20grad%20%3D%20-%20n2%20%2F%20(t%20*%20(1.0%20%2B%201.0%2Flamb))%0A%0A%20%20%20%20%20%20%20%20return%20grad%0A%0A%20%20%20%20def%20tangency_time_func(m_variable%2C%20c_variable%2C%20m_fixed%2C%20c_fixed)%3A%0A%20%20%20%20%20%20%20%20pcoef%20%3D%20ellphi.coef_from_cov(m_fixed%2C%20c_fixed)%0A%20%20%20%20%20%20%20%20qcoef%20%3D%20ellphi.coef_from_cov(m_variable%2C%20c_variable)%0A%20%20%20%20%20%20%20%20res%20%3D%20ellphi.tangency(pcoef%2C%20qcoef)%0A%20%20%20%20%20%20%20%20return%20res.t%0A%20%20%20%20return%20compute_analytical_gradient%2C%20tangency_time_func%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20compute_analytical_gradient%2C%0A%20%20%20%20ellphi%2C%0A%20%20%20%20generate_random_ellipsoid%2C%0A%20%20%20%20norm%2C%0A%20%20%20%20np%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20plt%2C%0A%20%20%20%20sns%2C%0A%20%20%20%20tangency_time_func%2C%0A%20%20%20%20tqdm%2C%0A)%3A%0A%20%20%20%20def%20verify_gradients()%3A%0A%20%20%20%20%20%20%20%20dims%20%3D%20%5B2%2C%205%2C%2010%2C%2020%2C%2050%5D%0A%20%20%20%20%20%20%20%20epsilon%20%3D%201e-6%0A%20%20%20%20%20%20%20%20results%20%3D%20%5B%5D%0A%0A%20%20%20%20%20%20%20%20%23%20For%20scatter%20plot%0A%20%20%20%20%20%20%20%20scatter_data%20%3D%20%7B'num'%3A%20%5B%5D%2C%20'ana'%3A%20%5B%5D%7D%0A%0A%20%20%20%20%20%20%20%20for%20dim%20in%20tqdm(dims%2C%20desc%3D%22Verifying%20Gradients%22)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Use%2010%20samples%20per%20dimension%20for%20statistics%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20_%20in%20range(10)%3A%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20m1%2C%20c1%20%3D%20generate_random_ellipsoid(dim)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20m2%2C%20c2%20%3D%20generate_random_ellipsoid(dim)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Base%20computation%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pcoef%20%3D%20ellphi.coef_from_cov(m1%2C%20c1)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20qcoef%20%3D%20ellphi.coef_from_cov(m2%2C%20c2)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20res%20%3D%20ellphi.tangency(pcoef%2C%20qcoef)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20t_base%20%3D%20res.t%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20point%20%3D%20res.point%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Analytical%20Gradient%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20grad_ana%20%3D%20compute_analytical_gradient(m1%2C%20c1%2C%20m2%2C%20c2%2C%20t_base%2C%20point)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Numerical%20Gradient%20(Finite%20Difference%20on%20m2)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20grad_num%20%3D%20np.zeros(dim)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20i%20in%20range(dim)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20m2_plus%20%3D%20m2.copy()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20m2_plus%5Bi%5D%20%2B%3D%20epsilon%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20t_plus%20%3D%20tangency_time_func(m2_plus%2C%20c2%2C%20m1%2C%20c1)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20m2_minus%20%3D%20m2.copy()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20m2_minus%5Bi%5D%20-%3D%20epsilon%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20t_minus%20%3D%20tangency_time_func(m2_minus%2C%20c2%2C%20m1%2C%20c1)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20grad_num%5Bi%5D%20%3D%20(t_plus%20-%20t_minus)%20%2F%20(2%20*%20epsilon)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Compare%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Relative%20Error%3A%20%7C%7Cana%20-%20num%7C%7C%20%2F%20%7C%7Cana%7C%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20diff_norm%20%3D%20norm(grad_ana%20-%20grad_num)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ana_norm%20%3D%20norm(grad_ana)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20ana_norm%20%3C%201e-12%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20rel_error%20%3D%200.0%20%23%20Should%20not%20happen%20with%20random%20ellipsoids%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20rel_error%20%3D%20diff_norm%20%2F%20ana_norm%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20results.append(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Dimension%22%3A%20dim%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Relative%20Error%22%3A%20rel_error%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Log10%20Error%22%3A%20np.log10(rel_error%20%2B%201e-20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20scatter_data%5B'num'%5D.extend(grad_num.tolist())%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20scatter_data%5B'ana'%5D.extend(grad_ana.tolist())%0A%0A%20%20%20%20%20%20%20%20return%20pd.DataFrame(results)%2C%20pd.DataFrame(scatter_data)%0A%0A%20%20%20%20df_grads%2C%20df_scatter%20%3D%20verify_gradients()%0A%0A%20%20%20%20%23%20Save%20results%0A%20%20%20%20df_grads.to_csv(%22experiments%2Fapct_2025%2Fvalidation%2Fdata%2Fgradient_verification.csv%22%2C%20index%3DFalse)%0A%0A%20%20%20%20%23%20Plot%20Box%20Plot%0A%20%20%20%20fig2%2C%20ax2%20%3D%20plt.subplots(figsize%3D(6%2C%204))%0A%20%20%20%20sns.boxplot(data%3Ddf_grads%2C%20x%3D%22Dimension%22%2C%20y%3D%22Log10%20Error%22%2C%20ax%3Dax2)%0A%20%20%20%20ax2.axhline(np.log10(1e-5)%2C%20color%3D'r'%2C%20linestyle%3D'--'%2C%20label%3D'Threshold%20(%2410%5E%7B-5%7D%24)')%0A%20%20%20%20ax2.set_title(%22Gradient%20Verification%3A%20Relative%20Error%20Distribution%22)%0A%20%20%20%20ax2.legend()%0A%20%20%20%20plt.tight_layout()%0A%20%20%20%20plt.savefig(%22experiments%2Fapct_2025%2Fvalidation%2Ffigs%2Fgradient_verification.pdf%22)%0A%20%20%20%20plt.savefig(%22experiments%2Fapct_2025%2Fvalidation%2Ffigs%2Fgradient_verification.png%22)%0A%0A%20%20%20%20%23%20Plot%20Scatter%0A%20%20%20%20fig3%2C%20ax3%20%3D%20plt.subplots(figsize%3D(5%2C%205))%0A%20%20%20%20%23%20Subsample%20scatter%20if%20too%20large%0A%20%20%20%20sub_scatter%20%3D%20df_scatter.sample(n%3Dmin(1000%2C%20len(df_scatter)))%20if%20len(df_scatter)%20%3E%201000%20else%20df_scatter%0A%20%20%20%20ax3.scatter(sub_scatter%5B'num'%5D%2C%20sub_scatter%5B'ana'%5D%2C%20alpha%3D0.5%2C%20s%3D10)%0A%0A%20%20%20%20%23%20Diagonal%20line%0A%20%20%20%20lims%20%3D%20%5B%0A%20%20%20%20%20%20%20%20np.min(%5Bax3.get_xlim()%2C%20ax3.get_ylim()%5D)%2C%20%20%23%20min%20of%20both%20axes%0A%20%20%20%20%20%20%20%20np.max(%5Bax3.get_xlim()%2C%20ax3.get_ylim()%5D)%2C%20%20%23%20max%20of%20both%20axes%0A%20%20%20%20%5D%0A%20%20%20%20ax3.plot(lims%2C%20lims%2C%20'k-'%2C%20alpha%3D0.75%2C%20zorder%3D0)%0A%20%20%20%20ax3.set_xlabel(%22Numerical%20Gradient%22)%0A%20%20%20%20ax3.set_ylabel(%22Analytical%20Gradient%22)%0A%20%20%20%20ax3.set_title(%22Gradient%20Alignment%22)%0A%20%20%20%20plt.tight_layout()%0A%20%20%20%20plt.savefig(%22experiments%2Fapct_2025%2Fvalidation%2Ffigs%2Fgradient_scatter.png%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">ae76efebf9e1181742f3186895818a82</marimo-code-hash>
</body>
</html>
